class OntologyRanker

  WEIGHT = { 1353 => 1000, 1032 => 999, 1009 => 998, 1422 => 997, 1101 => 996, 1352 => 995, 1123 => 994, 1125 => 993, 1136 => 992, 1351 => 991, 1423 => 990, 1053 => 989, 1350 => 988, 1057 => 987, 1348 => 986, 1498 => 985, 1498 => 984, 1498 => 983, 1516 => 982, 1069 => 981, 1006 => 980, 1427 => 979, 1245 => 978, 1132 => 977, 1084 => 976, 1108 => 975, 1070 => 974, 1344 => 973, 1000 => 972, 1424 => 971, 1404 => 970, 1290 => 969, 1107 => 968, 1007 => 967, 1341 => 966, 1083 => 965, 1035 => 964, 1041 => 963, 1504 => 962, 1005 => 961, 1429 => 960, 1149 => 959, 1354 => 958, 1507 => 957, 1553 => 956, 1076 => 955, 1349 => 954, 1332 => 953, 1314 => 952, 1587 => 951, 1031 => 950, 1533 => 949, 1425 => 948, 1054 => 947, 1068 => 946, 1415 => 945, 1038 => 944, 1038 => 943, 1016 => 942, 1699 => 941, 1040 => 940, 1510 => 939, 1586 => 938, 1090 => 937, 1085 => 936, 1112 => 935, 1343 => 934, 1401 => 933, 1526 => 932, 1527 => 931, 1506 => 930, 1082 => 929, 1019 => 928, 1051 => 927, 1015 => 926, 1092 => 925, 1104 => 924, 1414 => 923, 1696 => 922, 1397 => 921, 1311 => 920, 1489 => 919, 1568 => 918, 1489 => 917, 1105 => 916, 1639 => 915, 1411 => 914, 1109 => 913, 1106 => 912, 1621 => 911, 1025 => 910, 1321 => 909, 1487 => 908, 1370 => 907, 3020 => 906, 3008 => 905, 1426 => 904, 1099 => 903, 1062 => 902, 1347 => 901, 1049 => 900, 1413 => 899, 1576 => 898, 1541 => 897, 1131 => 896, 1058 => 895, 1419 => 894, 1067 => 893, 1012 => 892, 1001 => 891, 1013 => 890, 1152 => 889, 1059 => 888, 1430 => 887, 1158 => 886, 1046 => 885, 1497 => 884, 1108 => 883, 1089 => 882, 1148 => 881, 1438 => 880, 3108 => 879, 1010 => 878, 1047 => 877, 1001 => 876, 1087 => 875, 1114 => 874, 1633 => 873, 1560 => 872, 1381 => 871, 1402 => 870, 1529 => 869, 1521 => 868, 1640 => 867, 1539 => 866, 3003 => 865, 1532 => 864, 1110 => 863, 1613 => 862, 1505 => 861, 1581 => 860, 3016 => 859, 1440 => 858, 1625 => 857, 1393 => 856, 1362 => 855, 1042 => 854, 1172 => 853, 1190 => 852, 1048 => 851, 1461 => 850, 3042 => 849, 3002 => 848, 1037 => 847, 1091 => 846, 1050 => 845, 1407 => 844, 1078 => 843, 1043 => 842, 1583 => 841, 1418 => 840, 1036 => 839, 1033 => 838, 1142 => 837, 1023 => 836, 1134 => 835, 1126 => 834, 1021 => 833, 1011 => 832, 1095 => 831, 1150 => 830, 1061 => 829, 1056 => 828, 1304 => 827, 1130 => 826, 1100 => 825, 1039 => 824, 1222 => 823, 1026 => 822, 1580 => 821, 1522 => 820, 1578 => 819, 1398 => 818, 1528 => 817, 1574 => 816, 1650 => 815, 1550 => 814, 1565 => 813, 1530 => 812, 1631 => 811, 1569 => 810, 1509 => 809, 1501 => 808, 1409 => 807, 1494 => 806, 1570 => 805, 1571 => 804, 1537 => 803, 1651 => 802, 3030 => 801, 1671 => 800, 3013 => 799, 1686 => 798, 3015 => 797, 3034 => 796, 1658 => 795, 1038 => 794, 1141 => 793, 3022 => 792, 3029 => 791, 3028 => 790, 1081 => 789, 1632 => 788, 1689 => 787, 1115 => 786, 1247 => 785, 1094 => 784, 1063 => 783, 1575 => 782, 1659 => 781, 1638 => 780, 3006 => 779, 1044 => 778, 1060 => 777, 1183 => 776, 1517 => 775, 3048 => 774, 1064 => 773, 1077 => 772, 1417 => 771, 3004 => 770, 1146 => 769, 1444 => 768, 1001 => 767, 1237 => 766, 1122 => 765, 1128 => 764, 1585 => 763, 1030 => 762, 1065 => 761, 1052 => 760, 1116 => 759, 1055 => 758, 1192 => 757, 1022 => 756, 1088 => 755, 1086 => 754, 1027 => 753, 1029 => 752, 1135 => 751, 1144 => 750, 1017 => 749, 1024 => 748, 1328 => 747, 1008 => 746, 1410 => 745, 1484 => 744, 1672 => 743, 1394 => 742, 1582 => 741, 1524 => 740, 1523 => 739, 1540 => 738, 1335 => 737, 1369 => 736, 1399 => 735, 1538 => 734, 1249 => 733, 3114 => 732, 1588 => 731, 1500 => 730, 1257 => 729, 1616 => 728, 1666 => 727, 1515 => 726, 1439 => 725, 1572 => 724, 1406 => 723, 1567 => 722, 1552 => 721, 1665 => 720, 1615 => 719, 1573 => 718, 1488 => 717, 1584 => 716, 1545 => 715, 1491 => 714, 1614 => 713, 1490 => 712, 3078 => 711, 1534 => 710, 3059 => 709, 3025 => 708, 3000 => 707, 3012 => 706, 1676 => 705, 3090 => 704, 3091 => 703, 3126 => 702, 3049 => 701, 1537 => 700, 3124 => 699, 3119 => 698, 3046 => 697, 3035 => 696, 3037 => 695, 1520 => 694, 3137 => 693, 3019 => 692, 3062 => 691, 1625 => 690, 1626 => 689, 1627 => 688, 3064 => 687, 1675 => 686, 3105 => 685, 3024 => 684, 3094 => 683, 3087 => 682, 1660 => 681, 3065 => 680, 3084 => 679, 3018 => 678, 3080 => 677, 1694 => 676, 3061 => 675, 3092 => 674, 1667 => 673, 3021 => 672, 1702 => 671, 3017 => 670, 1596 => 669, 1648 => 668, 1698 => 667, 3047 => 666, 1642 => 665, 1654 => 664, 1630 => 663, 3001 => 662, 1693 => 661, 1647 => 660, 1643 => 659, 3045 => 658, 1641 => 657, 3007 => 656, 3043 => 655, 3104 => 654, 1697 => 653, 3089 => 652, 1701 => 651, 1649 => 650, 1652 => 649, 1668 => 648, 1653 => 647, 3038 => 646, 3044 => 645, 1661 => 644, 1629 => 643, 3032 => 642, 1670 => 641, 3081 => 640, 3050 => 639, 3014 => 638, 1691 => 637, 3120 => 636, 3125 => 635, 3129 => 634, 3131 => 633, 3134 => 632, 3135 => 631, 3136 => 630, 3143 => 629, 3146 => 628, 3153 => 627, 3154 => 626, 3155 => 625, 3156 => 624, 3157 => 623, 3158 => 622, 3163 => 621, 3164 => 620, 3167 => 619, 3169 => 618, 3031 => 617, 3077 => 616, 1682 => 615, 3127 => 614, 3150 => 613, 3151 => 612, 3152 => 611, 3162 => 610, 3147 => 609, 1555 => 608, 3139 => 607, 1014 => 606, 1224 => 605, 3159 => 604, 1684 => 603, 3066 => 602, 3100 => 601, 3086 => 600, 3095 => 599, 3060 => 598, 3088 => 597, 1683 => 596, 1680 => 595, 1681 => 594, 1679 => 593, 3098 => 592, 3099 => 591, 3101 => 590, 3103 => 589, 3107 => 588, 3111 => 587, 3112 => 586, 3113 => 585, 3096 => 584, 3097 => 583, 1688 => 582, 3115 => 581, 3116 => 580, 3117 => 579, 3118 => 578, 3132 => 577, 3133 => 576, 3138 => 575, 3140 => 574, 3141 => 573, 3142 => 572, 3144 => 571, 3148 => 570, 3149 => 569, 3161 => 568, 3165 => 567, 3166 => 566 }

  ##
  # Takes an array of integers, arrays, or hashes. If using array or hash, must provide location of ontology virtual id.
  # Options:
  # :position => location in the array (int) or hash key containing the virtual id
  def self.rank(ont_ary, options = {})
    return nil if !ont_ary.kind_of?(Array)
    position = options[:position]

    ranked = []
    not_ranked = []
    ont_ary.each do |ont|
      if position.nil?
        if WEIGHT.key?(ont.to_i)
          ranked << ont
        else
          not_ranked << ont
        end
      else
        if WEIGHT.key?(ont[position].to_i)
          ranked << ont
        else
          not_ranked << ont
        end
      end
    end

    # Sort ontologies
    if position.nil?
      ranked.sort! {|a,b| WEIGHT[b.to_i] <=> WEIGHT[a.to_i]}
    else
      # Get a ranked list of the virtual ids in the ranked set
      ranked.sort! {|a,b| WEIGHT[b[position].to_i] <=> WEIGHT[a[position].to_i]}
    end

    # Recombine the ranked and non-ranked
    ranked.concat not_ranked
  end

  def self.rank!(ont_ary, options = {})
    ont_ary = self.rank(ont_ary, options)
  end

end